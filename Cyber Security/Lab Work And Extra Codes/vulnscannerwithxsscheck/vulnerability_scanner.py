import scanner

target_url = "http://192.168.254.129/dvwa/"  # it will be only able to fetch login page as first is login on dvwa
links_to_ignore = ["http://192.168.254.129/dvwa/logout.php"]
data_dict = {"username": "admin", "password": "password", "Login": "submit"}

vuln_scanner = scanner.Scanner(target_url, links_to_ignore)  # it is instance of scanner class
vuln_scanner.session.post("http://192.168.254.129/dvwa/login.php",
                          data=data_dict)
#vuln_scanner.session.post("http://192.168.254.129/dvwa/security.php", data={"security": "low"})
# openning brwoser and do all in one session
# vuln_scanner.crawl() #it will be able to crawl all pages of target website
# i dont want to crawl i want to extract it from xss reflected
forms = vuln_scanner.extract_forms("http://192.168.254.129/dvwa/vulnerabilities/xss_r/")
#print(forms) #extract forms
response = vuln_scanner.submit_form(forms[0], "testtest", "http://192.168.254.129/dvwa/vulnerabilities/xss_r/")
#forms[0]= selecting first element of forms
#print(response)
#after this you will get output as "hello testtest" , same you can check in xss reflected
response = vuln_scanner.test_xss_in_form(forms[0], "http://192.168.254.129/dvwa/vulnerabilities/xss_r/")
print(response)